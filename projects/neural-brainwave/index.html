<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEURAL SYMPHONY 路 brainwave orchestra</title>
    <!-- single file 路 EEG visualization + generative music + harmonic resonance -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0718;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Aeonik', 'Inter', system-ui, sans-serif;
            overflow: hidden;
        }

        .neural-concert {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: radial-gradient(circle at 30% 30%, #1a1035, #020110);
            overflow: hidden;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
        }

        #waveCanvas {
            z-index: 1;
            filter: blur(2px) brightness(1.2);
            mix-blend-mode: screen;
        }

        #brainCanvas {
            z-index: 2;
            mix-blend-mode: lighten;
        }

        #harmonyCanvas {
            z-index: 3;
            pointer-events: none;
        }

        .orchestra-panel {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            background: rgba(20, 10, 40, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(150, 100, 255, 0.8);
            border-radius: 60px 60px 30px 30px;
            padding: 1.5rem 3rem;
            display: flex;
            gap: 3rem;
            color: #d0b0ff;
            box-shadow: 0 0 60px #8a4fff, 0 20px 40px black;
            pointer-events: auto;
        }

        .brainwave {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
        }

        .wave-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            opacity: 0.7;
        }

        .wave-value {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, #a88eff, #ff8ec8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px #f6f;
        }

        .wave-bar {
            width: 120px;
            height: 8px;
            background: #221133;
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }

        .wave-fill {
            height: 100%;
            width: 50%;
            background: linear-gradient(90deg, #b380ff, #ff80bf);
            border-radius: 4px;
            box-shadow: 0 0 20px #f6f;
        }

        .frequency-dial {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #ff66cc, #aa44ff, #4169ff, #ff66cc);
            border: 4px solid white;
            box-shadow: 0 0 50px #cf9fff;
            position: relative;
            cursor: pointer;
        }

        .dial-marker {
            width: 4px;
            height: 35px;
            background: white;
            position: absolute;
            left: 50%;
            top: 5px;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(45deg);
            border-radius: 4px;
            box-shadow: 0 0 20px cyan;
        }

        .brain-badge {
            position: absolute;
            top: 40px;
            left: 40px;
            z-index: 10;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            border: 2px solid #b07eff;
            border-radius: 40px;
            padding: 1rem 2.5rem;
            color: white;
            font-size: 1.8rem;
            letter-spacing: 4px;
            box-shadow: 0 0 50px #b47aff;
        }

        .neural-stats {
            position: absolute;
            top: 40px;
            right: 40px;
            z-index: 10;
            display: flex;
            gap: 2rem;
        }

        .stat-card {
            background: rgba(30, 0, 50, 0.6);
            backdrop-filter: blur(8px);
            border: 2px solid #ff88cc;
            border-radius: 30px;
            padding: 1rem 2rem;
            text-align: center;
            color: #ffccff;
            min-width: 120px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            line-height: 1;
        }

        .current-note {
            position: absolute;
            bottom: 200px;
            left: 60px;
            z-index: 10;
            background: rgba(40, 0, 60, 0.7);
            backdrop-filter: blur(4px);
            padding: 1rem 2rem;
            border-radius: 40px;
            border-left: 8px solid #f6f;
            color: #ffccff;
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 0 0 30px #f6f;
        }
    </style>
</head>
<body>
    <div class="neural-concert">
        <canvas id="waveCanvas"></canvas>
        <canvas id="brainCanvas"></canvas>
        <canvas id="harmonyCanvas"></canvas>

        <!-- brainwave control panel -->
        <div class="orchestra-panel">
            <div class="brainwave">
                <span class="wave-label">DELTA (0.5-4Hz)</span>
                <div class="wave-bar">
                    <div class="wave-fill" id="deltaFill" style="width: 30%;"></div>
                </div>
                <span class="wave-value" id="deltaVal">0.3</span>
            </div>

            <div class="brainwave">
                <span class="wave-label">THETA (4-8Hz)</span>
                <div class="wave-bar">
                    <div class="wave-fill" id="thetaFill" style="width: 45%;"></div>
                </div>
                <span class="wave-value" id="thetaVal">0.45</span>
            </div>

            <div class="brainwave">
                <span class="wave-label">ALPHA (8-12Hz)</span>
                <div class="wave-bar">
                    <div class="wave-fill" id="alphaFill" style="width: 60%;"></div>
                </div>
                <span class="wave-value" id="alphaVal">0.6</span>
            </div>

            <div class="brainwave">
                <span class="wave-label">BETA (12-30Hz)</span>
                <div class="wave-bar">
                    <div class="wave-fill" id="betaFill" style="width: 40%;"></div>
                </div>
                <span class="wave-value" id="betaVal">0.4</span>
            </div>

            <div class="brainwave">
                <span class="wave-label">GAMMA (30-50Hz)</span>
                <div class="wave-bar">
                    <div class="wave-fill" id="gammaFill" style="width: 25%;"></div>
                </div>
                <span class="wave-value" id="gammaVal">0.25</span>
            </div>
        </div>

        <div class="brain-badge"> NEURAL SYMPHONY 路 OP.42</div>
        
        <div class="neural-stats">
            <div class="stat-card">
                <div class="stat-number" id="bpmDisplay">72</div>
                <div>BPM</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="keyDisplay">Am</div>
                <div>KEY</div>
            </div>
        </div>

        <div class="current-note" id="noteDisplay">
            C4 路 261Hz
        </div>
    </div>

    <script>
        (function() {
            // ---------- NEURAL SYMPHONY ----------
            // Simulated brainwave-to-music generation
            
            const waveCanvas = document.getElementById('waveCanvas');
            const brainCanvas = document.getElementById('brainCanvas');
            const harmonyCanvas = document.getElementById('harmonyCanvas');
            
            const ctxWave = waveCanvas.getContext('2d');
            const ctxBrain = brainCanvas.getContext('2d');
            const ctxHarmony = harmonyCanvas.getContext('2d');

            let width, height;
            let time = 0;

            // brainwave frequencies (simulated)
            let delta = 0.3;    // deep sleep
            let theta = 0.45;   // meditation
            let alpha = 0.6;    // relaxed
            let beta = 0.4;     // active
            let gamma = 0.25;    // insight

            // musical parameters
            let bpm = 72;
            let keyIndex = 0; // 0:Am, 1:C, 2:G, 3:Em, 4:F
            const keys = ['Am', 'C', 'G', 'Em', 'F'];
            const notes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
            
            let currentNote = 'C4';
            let currentFreq = 261.63;

            // UI elements
            const deltaFill = document.getElementById('deltaFill');
            const thetaFill = document.getElementById('thetaFill');
            const alphaFill = document.getElementById('alphaFill');
            const betaFill = document.getElementById('betaFill');
            const gammaFill = document.getElementById('gammaFill');
            
            const deltaVal = document.getElementById('deltaVal');
            const thetaVal = document.getElementById('thetaVal');
            const alphaVal = document.getElementById('alphaVal');
            const betaVal = document.getElementById('betaVal');
            const gammaVal = document.getElementById('gammaVal');
            
            const bpmDisplay = document.getElementById('bpmDisplay');
            const keyDisplay = document.getElementById('keyDisplay');
            const noteDisplay = document.getElementById('noteDisplay');

            // resize
            function resizeCanvases() {
                width = window.innerWidth;
                height = window.innerHeight;
                waveCanvas.width = width;
                waveCanvas.height = height;
                brainCanvas.width = width;
                brainCanvas.height = height;
                harmonyCanvas.width = width;
                harmonyCanvas.height = height;
            }
            window.addEventListener('resize', resizeCanvases);
            resizeCanvases();

            // simulate brainwave evolution (chaotic but smooth)
            function updateBrainwaves() {
                // slow oscillation of brainwaves
                delta = 0.2 + 0.2 * Math.sin(time * 0.3) + 0.1 * Math.sin(time * 0.7);
                theta = 0.3 + 0.3 * Math.sin(time * 0.5 + 1) + 0.1 * Math.sin(time * 1.2);
                alpha = 0.4 + 0.4 * Math.sin(time * 0.4 + 2) + 0.1 * Math.sin(time * 0.9);
                beta = 0.2 + 0.3 * Math.sin(time * 0.6 + 3) + 0.15 * Math.sin(time * 1.5);
                gamma = 0.1 + 0.2 * Math.sin(time * 0.8 + 4) + 0.1 * Math.sin(time * 2.0);
                
                // normalize to 0-1 range
                delta = Math.max(0.1, Math.min(0.9, delta));
                theta = Math.max(0.1, Math.min(0.9, theta));
                alpha = Math.max(0.1, Math.min(0.9, alpha));
                beta = Math.max(0.1, Math.min(0.9, beta));
                gamma = Math.max(0.1, Math.min(0.9, gamma));
                
                // update UI
                deltaFill.style.width = (delta * 100) + '%';
                thetaFill.style.width = (theta * 100) + '%';
                alphaFill.style.width = (alpha * 100) + '%';
                betaFill.style.width = (beta * 100) + '%';
                gammaFill.style.width = (gamma * 100) + '%';
                
                deltaVal.innerText = delta.toFixed(2);
                thetaVal.innerText = theta.toFixed(2);
                alphaVal.innerText = alpha.toFixed(2);
                betaVal.innerText = beta.toFixed(2);
                gammaVal.innerText = gamma.toFixed(2);
            }

            // convert brainwaves to music parameters
            function brainwaveToMusic() {
                // BPM = 60 + 40 * alpha + 20 * beta (relaxed to active)
                bpm = Math.round(60 + 30 * alpha + 20 * beta);
                bpmDisplay.innerText = bpm;
                
                // key changes with theta/gamma
                let keyScore = theta * 2 + gamma * 3;
                keyIndex = Math.floor(keyScore * 2) % keys.length;
                keyDisplay.innerText = keys[keyIndex];
                
                // generate note based on alpha and delta
                let noteIndex = Math.floor(alpha * 12) % 12;
                let octave = 3 + Math.floor(theta * 3);
                currentNote = notes[noteIndex] + octave;
                
                // frequency calculation (A4 = 440Hz)
                let a4Index = notes.indexOf('A') + 4 * 12;
                let noteSemitone = noteIndex + octave * 12;
                let semitoneDiff = noteSemitone - 57; // A4 is 57 semitones from C0
                currentFreq = 440 * Math.pow(2, semitoneDiff / 12);
                
                noteDisplay.innerText = currentNote + ' 路 ' + Math.round(currentFreq) + 'Hz';
            }

            // draw brainwave patterns
            function drawBrainwaves() {
                ctxBrain.clearRect(0, 0, width, height);
                
                // draw EEG-like lines for each band
                const bands = [
                    { value: delta, color: '#ff4444', label: '未' },
                    { value: theta, color: '#44ff44', label: '胃' },
                    { value: alpha, color: '#4444ff', label: '伪' },
                    { value: beta, color: '#ffff44', label: '尾' },
                    { value: gamma, color: '#ff44ff', label: '纬' }
                ];
                
                bands.forEach((band, idx) => {
                    let offset = idx * 80 + 100;
                    let amp = band.value * 100;
                    let freq = 2 + idx * 2;
                    
                    ctxBrain.beginPath();
                    for (let x = 0; x < width; x += 10) {
                        let t = x / width;
                        let y = offset + 
                               Math.sin(x * 0.01 * freq + time * freq) * amp +
                               Math.cos(x * 0.02 + time * 0.5) * amp * 0.3;
                        
                        if (x === 0) ctxBrain.moveTo(x, y);
                        else ctxBrain.lineTo(x, y);
                    }
                    ctxBrain.strokeStyle = band.color + '80';
                    ctxBrain.lineWidth = 3;
                    ctxBrain.shadowColor = band.color;
                    ctxBrain.shadowBlur = 20;
                    ctxBrain.stroke();
                    
                    // label
                    ctxBrain.font = 'bold 24px monospace';
                    ctxBrain.fillStyle = band.color;
                    ctxBrain.shadowBlur = 30;
                    ctxBrain.fillText(band.label, 30, offset - 20);
                });
            }

            // draw harmonic waves (musical visualization)
            function drawHarmonics() {
                ctxHarmony.clearRect(0, 0, width, height);
                
                // draw frequency spectrum based on current note
                let fundamental = currentFreq;
                let harmonics = [1, 2, 3, 4, 5, 6, 7, 8];
                
                harmonics.forEach((harmonic, idx) => {
                    let freq = fundamental * harmonic;
                    let amp = 1 / harmonic; // natural harmonic series
                    
                    // adjust amplitude based on brainwaves
                    amp *= alpha * (1 + Math.sin(time * harmonic));
                    
                    let x = width/2 + Math.sin(time * 0.5 + idx) * 200 * amp;
                    let y = height/2 + Math.cos(time * 0.3 + idx) * 200 * amp;
                    
                    // draw harmonic circle
                    ctxHarmony.beginPath();
                    ctxHarmony.arc(x, y, 50 * amp, 0, 2 * Math.PI);
                    
                    let hue = (harmonic * 30 + time * 10) % 360;
                    ctxHarmony.fillStyle = `hsla(${hue}, 80%, 60%, 0.2)`;
                    ctxHarmony.shadowColor = `hsl(${hue}, 90%, 70%)`;
                    ctxHarmony.shadowBlur = 40;
                    ctxHarmony.fill();
                    
                    // draw connection to center
                    ctxHarmony.beginPath();
                    ctxHarmony.moveTo(width/2, height/2);
                    ctxHarmony.lineTo(x, y);
                    ctxHarmony.strokeStyle = `hsla(${hue}, 80%, 70%, 0.3)`;
                    ctxHarmony.lineWidth = 2;
                    ctxHarmony.stroke();
                });
                
                // draw central "brain" nucleus
                ctxHarmony.beginPath();
                ctxHarmony.arc(width/2, height/2, 80 + 20 * Math.sin(time), 0, 2*Math.PI);
                ctxHarmony.fillStyle = 'rgba(255, 200, 255, 0.1)';
                ctxHarmony.shadowColor = '#f6f';
                ctxHarmony.shadowBlur = 60;
                ctxHarmony.fill();
            }

            // draw waveform (background)
            function drawWaveform() {
                ctxWave.clearRect(0, 0, width, height);
                
                // composite waveform from all brainwaves
                ctxWave.beginPath();
                for (let x = 0; x < width; x += 5) {
                    let t = x / width;
                    
                    // mix all bands
                    let wave = 0;
                    wave += delta * Math.sin(t * 20 + time * 2);
                    wave += theta * Math.sin(t * 40 + time * 3);
                    wave += alpha * Math.sin(t * 60 + time * 4);
                    wave += beta * Math.sin(t * 80 + time * 5);
                    wave += gamma * Math.sin(t * 100 + time * 6);
                    
                    wave = wave / 3; // normalize
                    
                    let y = height/2 + wave * height * 0.3;
                    
                    if (x === 0) ctxWave.moveTo(x, y);
                    else ctxWave.lineTo(x, y);
                }
                
                // gradient stroke
                let gradient = ctxWave.createLinearGradient(0, 0, width, 0);
                gradient.addColorStop(0, '#ff44ff');
                gradient.addColorStop(0.5, '#44ffff');
                gradient.addColorStop(1, '#ffff44');
                
                ctxWave.strokeStyle = gradient;
                ctxWave.lineWidth = 4;
                ctxWave.shadowColor = '#f6f';
                ctxWave.shadowBlur = 40;
                ctxWave.stroke();
                
                // fill under wave
                ctxWave.lineTo(width, height);
                ctxWave.lineTo(0, height);
                ctxWave.closePath();
                ctxWave.fillStyle = 'rgba(100, 0, 100, 0.1)';
                ctxWave.fill();
            }

            // generate audio (simulated - would use Web Audio API in real version)
            function simulateAudio() {
                // This is a placeholder for actual audio synthesis
                // In a real implementation, we would create oscillators
                // with frequencies based on brainwaves
                
                // For now, we just update the visual representation
            }

            // animation loop
            function animate() {
                time += 0.02;
                
                updateBrainwaves();
                brainwaveToMusic();
                simulateAudio();
                
                drawBrainwaves();
                drawHarmonics();
                drawWaveform();
                
                requestAnimationFrame(animate);
            }
            animate();

            // interactive dials (placeholders for future expansion)
            // could add frequency adjustment for each band
        })();
    </script>
</div>
</body>
</html>