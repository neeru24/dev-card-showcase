<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta name="description" content="RoninEngine — Cinematic 2D Samurai Duel Simulator" />
  <title>RoninEngine</title>
  <link rel="stylesheet" href="css/main.css" />
</head>
<body>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!--  TITLE SCREEN                                         -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div id="titleScreen">
    <div class="title-glow">浪人</div>
    <h1 class="title-main">RONIN<span>ENGINE</span></h1>
    <p class="title-sub">Cinematic Samurai Duel Simulator</p>
    <button id="startBtn" class="btn-start">BEGIN THE DUEL</button>
    <div class="controls-hint">
      <span>A / D — Move</span>
      <span>J — Light Strike</span>
      <span>K — Heavy Strike</span>
      <span>L — Block</span>
      <span>Space — Dash</span>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!--  GAME CANVAS                                          -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div id="gameWrapper" class="hidden">
    <canvas id="roninCanvas"></canvas>

    <!-- ── Toggle bar ───────────────────────────────────── -->
    <div id="toggleBar">
      <button class="toggle-btn" id="btnSlowMo"  title="Z">SLOW  MO</button>
      <button class="toggle-btn" id="btnDebug"   title="X">DEBUG</button>
      <button class="toggle-btn" id="btnCloth"   title="C">CLOTH</button>
      <button class="toggle-btn" id="btnPause"   title="P">PAUSE</button>
    </div>

    <!-- ── Mobile touch controls ─────────────────────────── -->
    <div id="touchControls">
      <div class="touch-row touch-left">
        <button class="touch-btn" data-action="left">◀</button>
        <button class="touch-btn" data-action="right">▶</button>
      </div>
      <div class="touch-row touch-right">
        <button class="touch-btn attack-light" data-action="attackLight">J</button>
        <button class="touch-btn attack-heavy" data-action="attackHeavy">K</button>
        <button class="touch-btn block-btn"    data-action="block">L</button>
        <button class="touch-btn dash-btn"     data-action="dash">⚡</button>
      </div>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!--  Scripts                                              -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <script type="module" src="js/main.js"></script>
  <script>
    // Title screen → game transition
    document.addEventListener('DOMContentLoaded', () => {
      const title   = document.getElementById('titleScreen');
      const wrapper = document.getElementById('gameWrapper');
      const startBtn = document.getElementById('startBtn');

      function startGame() {
        title.classList.add('fade-out');
        setTimeout(() => {
          title.style.display  = 'none';
          wrapper.classList.remove('hidden');
        }, 800);
      }

      startBtn.addEventListener('click', startGame);
      document.addEventListener('keydown', e => {
        if (e.code === 'Enter' || e.code === 'Space') startGame();
      }, { once: true });

      // Toggle bar wiring
      const map = {
        btnSlowMo : 'Z',
        btnDebug  : 'X',
        btnCloth  : 'C',
        btnPause  : 'P',
      };
      Object.entries(map).forEach(([id, key]) => {
        const btn = document.getElementById(id);
        if (!btn) return;
        btn.addEventListener('click', () => {
          document.dispatchEvent(new KeyboardEvent('keydown', { code: `Key${key}` }));
          btn.classList.toggle('active');
        });
      });
    });
  </script>
</body>
</html>
