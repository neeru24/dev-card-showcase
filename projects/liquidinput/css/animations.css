/**
 * LiquidInput - Animations Stylesheet
 * 
 * Burst animations, spill transitions, and dynamic visual feedback.
 * Handles the dramatic state changes when pressure exceeds limits.
 */

/* ============================================================================
   Burst Animation Sequence
   ========================================================================= */

/* Container shake before burst */
@keyframes containerShake {

    0%,
    100% {
        transform: translate(0, 0) rotate(0deg);
    }

    10% {
        transform: translate(-2px, -1px) rotate(-0.5deg);
    }

    20% {
        transform: translate(2px, 1px) rotate(0.5deg);
    }

    30% {
        transform: translate(-3px, -2px) rotate(-0.8deg);
    }

    40% {
        transform: translate(3px, 2px) rotate(0.8deg);
    }

    50% {
        transform: translate(-4px, -2px) rotate(-1deg);
    }

    60% {
        transform: translate(4px, 2px) rotate(1deg);
    }

    70% {
        transform: translate(-3px, -1px) rotate(-0.8deg);
    }

    80% {
        transform: translate(3px, 1px) rotate(0.8deg);
    }

    90% {
        transform: translate(-2px, -1px) rotate(-0.5deg);
    }
}

.glass-container.shaking {
    animation: containerShake 0.5s ease-in-out;
}

/* Crack overlay effect */
.container-overlay.cracking {
    opacity: 1;
    background:
        linear-gradient(45deg, transparent 48%, rgba(239, 68, 68, 0.8) 49%, rgba(239, 68, 68, 0.8) 51%, transparent 52%),
        linear-gradient(-45deg, transparent 48%, rgba(239, 68, 68, 0.6) 49%, rgba(239, 68, 68, 0.6) 51%, transparent 52%),
        linear-gradient(30deg, transparent 48%, rgba(239, 68, 68, 0.4) 49%, rgba(239, 68, 68, 0.4) 51%, transparent 52%),
        linear-gradient(-30deg, transparent 48%, rgba(239, 68, 68, 0.4) 49%, rgba(239, 68, 68, 0.4) 51%, transparent 52%);
    background-size: 100% 100%;
    animation: crackSpread 0.4s ease-out forwards;
}

@keyframes crackSpread {
    0% {
        background-size: 0% 0%;
        opacity: 0;
    }

    100% {
        background-size: 100% 100%;
        opacity: 1;
    }
}

/* Shatter effect */
.container-overlay.shattering {
    animation: shatterEffect 0.6s ease-out forwards;
}

@keyframes shatterEffect {
    0% {
        opacity: 1;
        transform: scale(1);
    }

    50% {
        opacity: 0.8;
        transform: scale(1.02);
        filter: blur(0px);
    }

    100% {
        opacity: 0;
        transform: scale(1.1);
        filter: blur(10px);
    }
}

/* ============================================================================
   Particle Spill Animations
   ========================================================================= */

/* Particle explosion from container */
@keyframes particleExplosion {
    0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
    }

    100% {
        transform: translate(var(--explosion-x), var(--explosion-y)) scale(0.8);
        opacity: 0.9;
    }
}

/* Particle fade in when created */
@keyframes particleFadeIn {
    0% {
        opacity: 0;
        transform: scale(0.5);
    }

    100% {
        opacity: 1;
        transform: scale(1);
    }
}

/* Particle fade out when removed */
@keyframes particleFadeOut {
    0% {
        opacity: 1;
        transform: scale(1);
    }

    100% {
        opacity: 0;
        transform: scale(0.5);
    }
}

/* Gentle floating motion in calm state */
@keyframes gentleFloat {

    0%,
    100% {
        transform: translateY(0px);
    }

    50% {
        transform: translateY(-3px);
    }
}

/* Liquid ripple effect */
@keyframes liquidRipple {
    0% {
        transform: scale(1);
        opacity: 0.6;
    }

    100% {
        transform: scale(2);
        opacity: 0;
    }
}

/* ============================================================================
   Pressure Build-up Visual Feedback
   ========================================================================= */

/* Pressure warning flash */
@keyframes pressureWarning {

    0%,
    100% {
        background: rgba(239, 68, 68, 0.1);
    }

    50% {
        background: rgba(239, 68, 68, 0.3);
    }
}

.glass-container.pressure-warning {
    animation: pressureWarning 0.5s ease-in-out infinite;
}

/* Pressure indicator pulse */
@keyframes indicatorPulse {

    0%,
    100% {
        transform: scale(1);
        box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
    }

    50% {
        transform: scale(1.05);
        box-shadow: 0 0 20px rgba(239, 68, 68, 0.8);
    }
}

.pressure-indicator.critical {
    animation: indicatorPulse 0.6s ease-in-out infinite;
}

/* ============================================================================
   Spilled Particle Styles
   ========================================================================= */

.spilled-particle {
    position: absolute;
    font-family: 'Courier New', monospace;
    font-size: 1.5rem;
    color: #60a5fa;
    font-weight: 600;
    pointer-events: none;
    user-select: none;
    text-shadow:
        0 0 10px rgba(96, 165, 250, 0.8),
        0 0 20px rgba(96, 165, 250, 0.4);
    z-index: 10000;
    will-change: transform;
}

/* Spilled particle glow effect */
.spilled-particle::after {
    content: attr(data-char);
    position: absolute;
    top: 0;
    left: 0;
    color: rgba(96, 165, 250, 0.3);
    filter: blur(8px);
    z-index: -1;
}

/* Particle settling animation */
@keyframes particleSettle {
    0% {
        transform: translateY(0) rotate(0deg);
    }

    100% {
        transform: translateY(0) rotate(0deg);
        opacity: 0.8;
    }
}

.spilled-particle.settling {
    animation: particleSettle 1s ease-out forwards;
}

/* ============================================================================
   State Transition Animations
   ========================================================================= */

/* Calm to building transition */
@keyframes calmToBuilding {
    0% {
        filter: hue-rotate(0deg) brightness(1);
    }

    100% {
        filter: hue-rotate(30deg) brightness(1.1);
    }
}

.glass-container.transitioning-to-building {
    animation: calmToBuilding 0.5s ease-out forwards;
}

/* Building to critical transition */
@keyframes buildingToCritical {
    0% {
        filter: hue-rotate(30deg) brightness(1.1);
    }

    100% {
        filter: hue-rotate(60deg) brightness(1.2);
    }
}

.glass-container.transitioning-to-critical {
    animation: buildingToCritical 0.3s ease-out forwards;
}

/* Critical to burst transition */
@keyframes criticalToBurst {
    0% {
        transform: scale(1);
        filter: brightness(1.2);
    }

    30% {
        transform: scale(1.05);
        filter: brightness(1.5);
    }

    60% {
        transform: scale(0.98);
        filter: brightness(0.8);
    }

    100% {
        transform: scale(1);
        filter: brightness(1);
    }
}

.glass-container.transitioning-to-burst {
    animation: criticalToBurst 0.8s ease-out forwards;
}

/* Burst to calm transition (reset) */
@keyframes burstToCalm {
    0% {
        opacity: 0.3;
        transform: scale(0.95);
        filter: blur(5px);
    }

    100% {
        opacity: 1;
        transform: scale(1);
        filter: blur(0px);
    }
}

.glass-container.transitioning-to-calm {
    animation: burstToCalm 1s ease-out forwards;
}

/* ============================================================================
   Button Interaction Animations
   ========================================================================= */

/* Reset button click effect */
@keyframes resetPulse {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(0.95);
    }

    100% {
        transform: scale(1);
    }
}

.control-btn.clicked {
    animation: resetPulse 0.3s ease-out;
}

/* Clear button click effect */
@keyframes clearSweep {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

.control-btn.clearing {
    animation: clearSweep 0.5s ease-out;
}

/* ============================================================================
   Liquid Motion Effects
   ========================================================================= */

/* Liquid wave effect in container */
@keyframes liquidWave {
    0% {
        background-position: 0% 50%;
    }

    50% {
        background-position: 100% 50%;
    }

    100% {
        background-position: 0% 50%;
    }
}

.glass-container.liquid-active::before {
    background: linear-gradient(90deg,
            rgba(96, 165, 250, 0.1) 0%,
            rgba(167, 139, 250, 0.1) 50%,
            rgba(96, 165, 250, 0.1) 100%);
    background-size: 200% 200%;
    animation: liquidWave 3s ease-in-out infinite;
}

/* Droplet formation effect */
@keyframes dropletForm {
    0% {
        transform: scale(0) translateY(-20px);
        opacity: 0;
    }

    50% {
        transform: scale(1.2) translateY(-10px);
        opacity: 1;
    }

    100% {
        transform: scale(1) translateY(0);
        opacity: 1;
    }
}

.particle-droplet {
    animation: dropletForm 0.3s ease-out;
}

/* ============================================================================
   Performance Optimizations
   ========================================================================= */

/* Use GPU acceleration for animations */
.glass-container,
.spilled-particle,
.container-overlay,
.pressure-bar {
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px;
}

/* ============================================================================
   Responsive Animation Adjustments
   ========================================================================= */

@media (max-width: 768px) {
    .spilled-particle {
        font-size: 1.25rem;
    }

    @keyframes containerShake {

        0%,
        100% {
            transform: translate(0, 0) rotate(0deg);
        }

        50% {
            transform: translate(-2px, -1px) rotate(-0.5deg);
        }
    }
}

@media (max-width: 480px) {
    .spilled-particle {
        font-size: 1rem;
    }
}

/* ============================================================================
   Accessibility - Reduced Motion
   ========================================================================= */

@media (prefers-reduced-motion: reduce) {

    .glass-container,
    .spilled-particle,
    .container-overlay,
    .pressure-indicator {
        animation: none !important;
        transition: none !important;
    }

    /* Provide instant state changes instead of animations */
    .glass-container[data-state="burst"] {
        opacity: 0.5;
    }

    .container-overlay.cracking,
    .container-overlay.shattering {
        opacity: 0;
    }
}