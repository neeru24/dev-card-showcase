/* Reset */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* Root variables */
:root {
  --hue: 223;
  --primary100: hsl(var(--hue) 90% 95%);
  --primary300: hsl(var(--hue) 90% 75%);
  --primary500: hsl(var(--hue) 90% 55%);
  --primary900: hsl(var(--hue) 90% 15%);

  --stack-dur: 2s;
  --stack-delay: 0.05;
  --stack-spacing: 15%;

  --ease-in: cubic-bezier(0.32, 0, 0.67, 0);
  --ease-out: cubic-bezier(0.33, 1, 0.68, 1);
  --ease-in-out: cubic-bezier(0.65, 0, 0.35, 1);
}

/* Body */
body {
  background-color: var(--primary900);
  color: var(--primary100);
  font-family: sans-serif;
  display: grid;
  place-items: center;
  height: 100vh;
}

/* Stack container */
.stack {
  position: relative;
  width: 14em;
  height: 32em;
  overflow: hidden;
  perspective: 800px;
}

/* Cards */
.stack__card {
  position: absolute;
  inset: 0;
  top: var(--stack-spacing);
  margin: auto;
  width: 70%;
  aspect-ratio: 1;
  transform: rotateX(45deg) rotateZ(-45deg);
  transform-style: preserve-3d;
}

/* Card surface */
.stack__card::before {
  content: "";
  position: absolute;
  inset: 0;
  background-color: var(--primary500);
  border-radius: 8%;
  box-shadow: -0.5em 0.5em 1.5em hsl(var(--hue) 90% 15% / 0.25);
  animation: card var(--stack-dur) infinite;
}

/* Second card */
.stack__card:nth-child(2) {
  top: 0;
}

.stack__card:nth-child(2)::before {
  background-color: var(--primary300);
  animation-delay: calc(var(--stack-dur) * (-1 + var(--stack-delay)));
}

/* Third card */
.stack__card:nth-child(3) {
  top: calc(var(--stack-spacing) * -1);
}

.stack__card:nth-child(3)::before {
  background-color: var(--primary100);
  animation-delay: calc(var(--stack-dur) * (-1 + var(--stack-delay) * 2));
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8 0L1.03553 6.96447C0.372492 7.62751 0 8.52678 0 9.46447V9.54584C0 11.4535 1.54648 13 3.45416 13C4.1361 13 4.80278 12.7981 5.37019 12.4199L7.125 11.25L6 15V16H10V15L8.875 11.25L10.6298 12.4199C11.1972 12.7981 11.8639 13 12.5458 13C14.4535 13 16 11.4535 16 9.54584V9.46447C16 8.52678 15.6275 7.62751 14.9645 6.96447L8 0Z' fill='black'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 45% 45%;
}

/* Animation */
@keyframes card {
  0%,
  100% {
    animation-timing-function: var(--ease-in-out);
    transform: translateZ(0);
    opacity: 1;
  }

  11% {
    animation-timing-function: var(--ease-in);
    transform: translateZ(0.125em);
  }

  34% {
    animation-timing-function: steps(1);
    transform: translateZ(-12em);
    opacity: 0;
  }

  48% {
    transform: translateZ(12em);
    opacity: 0;
  }

  57% {
    animation-timing-function: var(--ease-out);
    transform: translateZ(0);
    opacity: 1;
  }

  61% {
    transform: translateZ(-1.8em);
  }

  74% {
    transform: translateZ(0.6em);
  }

  87% {
    transform: translateZ(-0.2em);
  }
}
