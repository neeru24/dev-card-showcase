<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Habit Garden</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        body {
            font-family: 'Press Start 2P', cursive, monospace;
            background-color: #2d1b69;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(75, 45, 140, 0.7) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(45, 27, 105, 0.9) 0%, transparent 20%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            border: 8px solid #ff66c4;
            background-color: #1a0b3a;
            box-shadow: 
                0 0 0 4px #ffcc00,
                0 0 30px rgba(255, 102, 196, 0.5);
            position: relative;
            overflow: hidden;
        }

        /* Retro scanlines effect */
        .container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                rgba(18, 16, 16, 0) 50%, 
                rgba(0, 0, 0, 0.25) 50%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 10;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            border-bottom: 4px dotted #ffcc00;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            color: #ffcc00;
            text-shadow: 
                3px 3px 0 #ff66c4,
                6px 6px 0 rgba(0, 0, 0, 0.7);
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        .subtitle {
            color: #5ce1e6;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }

        .habits-section {
            flex: 1;
            min-width: 300px;
            background-color: rgba(45, 27, 105, 0.8);
            border: 6px solid #5ce1e6;
            padding: 20px;
        }

        .pixel-garden {
            flex: 1;
            min-width: 300px;
            background-color: rgba(45, 27, 105, 0.8);
            border: 6px solid #ff66c4;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .section-title {
            font-size: 1.3rem;
            color: #ffcc00;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 3px dotted;
        }

        .habit-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .habit-item {
            display: flex;
            align-items: center;
            background-color: rgba(26, 11, 58, 0.9);
            padding: 15px;
            border: 3px solid #5ce1e6;
            transition: all 0.3s;
        }

        .habit-item:hover {
            transform: translateY(-5px);
            border-color: #ffcc00;
            box-shadow: 0 5px 0 rgba(255, 204, 0, 0.5);
        }

        .habit-checkbox {
            appearance: none;
            width: 30px;
            height: 30px;
            background-color: #1a0b3a;
            border: 3px solid #ff66c4;
            margin-right: 15px;
            cursor: pointer;
            position: relative;
        }

        .habit-checkbox:checked {
            background-color: #ffcc00;
            border-color: #ffcc00;
        }

        .habit-checkbox:checked::after {
            content: "âœ”";
            position: absolute;
            color: #1a0b3a;
            font-size: 20px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .habit-info {
            flex: 1;
        }

        .habit-name {
            font-size: 0.9rem;
            color: #fff;
            margin-bottom: 5px;
        }

        .habit-streak {
            display: flex;
            align-items: center;
            font-size: 0.7rem;
            color: #5ce1e6;
        }

        .streak-count {
            color: #ffcc00;
            margin-left: 5px;
        }

        .pixel-character {
            width: 160px;
            height: 160px;
            margin: 20px 0;
            position: relative;
        }

        .pixel-grid {
            display: grid;
            grid-template-columns: repeat(8, 20px);
            grid-template-rows: repeat(8, 20px);
            gap: 0;
            border: 4px solid #ffcc00;
            background-color: #1a0b3a;
        }

        .pixel {
            width: 20px;
            height: 20px;
        }

        .garden-info {
            margin-top: 20px;
            text-align: center;
        }

        .level-info {
            font-size: 1rem;
            color: #ffcc00;
            margin-bottom: 10px;
        }

        .xp-bar {
            width: 100%;
            height: 20px;
            background-color: #1a0b3a;
            border: 3px solid #5ce1e6;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .xp-fill {
            height: 100%;
            background-color: #ff66c4;
            width: 0%;
            transition: width 1s ease-in-out;
        }

        .stats-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(45, 27, 105, 0.8);
            border: 4px solid #ffcc00;
        }

        .stat-box {
            text-align: center;
            padding: 15px;
            min-width: 150px;
        }

        .stat-value {
            font-size: 2rem;
            color: #ff66c4;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #5ce1e6;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .pixel-button {
            font-family: 'Press Start 2P', cursive;
            background-color: #ff66c4;
            color: #fff;
            border: none;
            padding: 15px 25px;
            font-size: 0.9rem;
            cursor: pointer;
            border: 4px solid #ffcc00;
            transition: all 0.3s;
        }

        .pixel-button:hover {
            background-color: #ffcc00;
            color: #1a0b3a;
            transform: translateY(-5px);
            box-shadow: 0 5px 0 #ff66c4;
        }

        .pixel-button:active {
            transform: translateY(0);
            box-shadow: none;
        }

        .animation-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 5;
            overflow: hidden;
        }

        .pixel-effect {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #ffcc00;
            opacity: 0;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 4px dotted #ffcc00;
            font-size: 0.7rem;
            color: #5ce1e6;
        }

        @keyframes pixel-grow {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes celebrate {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
            100% { transform: translateY(0) rotate(360deg); }
        }

        @keyframes xp-pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 204, 0, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 204, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 204, 0, 0); }
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .pixel-button {
                padding: 12px 15px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="animation-container" id="animation-container"></div>
        
        <header>
            <h1>PIXEL HABIT GARDEN</h1>
            <p class="subtitle">GROW YOUR PIXEL PAL BY COMPLETING DAILY HABITS</p>
            <p class="subtitle">EACH CHECKBOX FILLS A PIXEL</p>
        </header>
        
        <div class="main-content">
            <section class="habits-section">
                <h2 class="section-title">DAILY HABITS</h2>
                <div class="habit-list" id="habit-list">
                    <!-- Habits will be generated here -->
                </div>
            </section>
            
            <section class="pixel-garden">
                <h2 class="section-title">PIXEL GARDEN</h2>
                <div class="pixel-character">
                    <div class="pixel-grid" id="pixel-grid">
                        <!-- Pixel grid will be generated here -->
                    </div>
                </div>
                
                <div class="garden-info">
                    <p class="level-info">LEVEL: <span id="level">1</span></p>
                    <div class="xp-bar">
                        <div class="xp-fill" id="xp-fill"></div>
                    </div>
                    <p>XP: <span id="current-xp">0</span>/<span id="max-xp">100</span></p>
                </div>
            </section>
        </div>
        
        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-value" id="total-completed">0</div>
                <div class="stat-label">HABITS TODAY</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="current-streak">0</div>
                <div class="stat-label">DAY STREAK</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="total-days">1</div>
                <div class="stat-label">TOTAL DAYS</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="pixel-growth">0%</div>
                <div class="stat-label">PIXEL GROWTH</div>
            </div>
        </div>
        
        <div class="controls">
            <button class="pixel-button" id="reset-day">
                <i class="fas fa-redo"></i> RESET TODAY
            </button>
            <button class="pixel-button" id="add-habit">
                <i class="fas fa-plus"></i> ADD HABIT
            </button>
            <button class="pixel-button" id="celebrate">
                <i class="fas fa-star"></i> CELEBRATE
            </button>
        </div>
        
        <footer>
            <p>PIXEL HABIT GARDEN v1.0 | KEEP YOUR STREAK ALIVE!</p>
            <p>EACH DAY YOU COMPLETE HABITS, YOUR PIXEL PAL GROWS</p>
        </footer>
    </div>

    <script>
        // Initialize data
        const habitsData = [
            { id: 1, name: "DRINK 8 GLASSES OF WATER", streak: 0, checked: false },
            { id: 2, name: "EXERCISE 30 MINUTES", streak: 0, checked: false },
            { id: 3, name: "READ FOR 20 MINUTES", streak: 0, checked: false },
            { id: 4, name: "MEDITATE 10 MINUTES", streak: 0, checked: false },
            { id: 5, name: "EAT HEALTHY MEALS", streak: 0, checked: false },
            { id: 6, name: "NO SCREEN BEFORE BED", streak: 0, checked: false }
        ];

        // Pixel character color palette
        const pixelColors = {
            empty: "#1a0b3a",
            level1: "#5ce1e6",
            level2: "#ff66c4",
            level3: "#ffcc00",
            level4: "#ff8c42",
            level5: "#9d4edd"
        };

        // Game state
        let gameState = {
            level: 1,
            xp: 0,
            maxXp: 100,
            totalDays: 1,
            currentStreak: 0,
            lastLoginDate: null,
            pixelGrid: Array(64).fill('empty'),
            habits: habitsData,
            totalCompleted: 0
        };

        // DOM elements
        const habitList = document.getElementById('habit-list');
        const pixelGrid = document.getElementById('pixel-grid');
        const levelElement = document.getElementById('level');
        const currentXpElement = document.getElementById('current-xp');
        const maxXpElement = document.getElementById('max-xp');
        const xpFillElement = document.getElementById('xp-fill');
        const totalCompletedElement = document.getElementById('total-completed');
        const currentStreakElement = document.getElementById('current-streak');
        const totalDaysElement = document.getElementById('total-days');
        const pixelGrowthElement = document.getElementById('pixel-growth');
        const animationContainer = document.getElementById('animation-container');
        
        // Buttons
        const resetDayButton = document.getElementById('reset-day');
        const addHabitButton = document.getElementById('add-habit');
        const celebrateButton = document.getElementById('celebrate');

        // Initialize the app
        function init() {
            loadGameState();
            checkDayReset();
            renderHabits();
            renderPixelGrid();
            updateStats();
            attachEventListeners();
        }

        // Load game state from localStorage
        function loadGameState() {
            const savedState = localStorage.getItem('pixelHabitGarden');
            if (savedState) {
                const parsedState = JSON.parse(savedState);
                gameState = { ...gameState, ...parsedState };
                
                // Update pixel grid colors based on level
                updatePixelGridColors();
            }
        }

        // Save game state to localStorage
        function saveGameState() {
            localStorage.setItem('pixelHabitGarden', JSON.stringify(gameState));
        }

        // Check if a new day has started
        function checkDayReset() {
            const today = new Date().toDateString();
            const lastLogin = gameState.lastLoginDate;
            
            if (!lastLogin || lastLogin !== today) {
                // New day, reset daily habits but keep streaks for completed ones
                gameState.habits.forEach(habit => {
                    // If habit was checked yesterday, increment streak
                    if (habit.checked) {
                        habit.streak++;
                    } else {
                        // Reset streak if not completed yesterday
                        habit.streak = 0;
                    }
                    habit.checked = false;
                });
                
                gameState.lastLoginDate = today;
                
                // If any habit was completed yesterday, increment streak
                const anyCompletedYesterday = gameState.habits.some(h => h.checked);
                if (anyCompletedYesterday) {
                    gameState.currentStreak++;
                } else {
                    gameState.currentStreak = 0;
                }
                
                gameState.totalDays++;
                gameState.totalCompleted = 0;
                
                saveGameState();
            }
        }

        // Render habits list
        function renderHabits() {
            habitList.innerHTML = '';
            
            gameState.habits.forEach(habit => {
                const habitElement = document.createElement('div');
                habitElement.className = 'habit-item';
                
                habitElement.innerHTML = `
                    <input type="checkbox" class="habit-checkbox" id="habit-${habit.id}" ${habit.checked ? 'checked' : ''}>
                    <div class="habit-info">
                        <div class="habit-name">${habit.name}</div>
                        <div class="habit-streak">
                            <i class="fas fa-fire"></i> STREAK: 
                            <span class="streak-count">${habit.streak}</span> DAYS
                        </div>
                    </div>
                `;
                
                habitList.appendChild(habitElement);
                
                // Add event listener to checkbox
                const checkbox = habitElement.querySelector('.habit-checkbox');
                checkbox.addEventListener('change', () => toggleHabit(habit.id));
            });
        }

        // Toggle habit completion
        function toggleHabit(habitId) {
            const habitIndex = gameState.habits.findIndex(h => h.id === habitId);
            if (habitIndex === -1) return;
            
            const habit = gameState.habits[habitIndex];
            habit.checked = !habit.checked;
            
            // Update total completed count
            gameState.totalCompleted = gameState.habits.filter(h => h.checked).length;
            
            // Add XP for completing a habit
            if (habit.checked) {
                addXp(10);
                
                // Add pixel to the grid
                addPixelToGrid();
                
                // Create celebration effect
                createPixelEffect();
            } else {
                // Remove XP if unchecking
                addXp(-10);
                
                // Remove a pixel from the grid
                removePixelFromGrid();
            }
            
            // Update streak for this habit
            if (habit.checked) {
                // If this is the first time checking today, increment streak
                if (!habit.streakIncreasedToday) {
                    habit.streak++;
                    habit.streakIncreasedToday = true;
                }
            }
            
            updateStats();
            renderHabits();
            saveGameState();
        }

        // Add XP and handle level up
        function addXp(amount) {
            gameState.xp += amount;
            
            // Ensure XP doesn't go below 0
            if (gameState.xp < 0) gameState.xp = 0;
            
            // Level up if XP reaches max
            if (gameState.xp >= gameState.maxXp) {
                gameState.level++;
                gameState.xp = gameState.xp - gameState.maxXp;
                gameState.maxXp = Math.floor(gameState.maxXp * 1.5);
                
                // Level up animation
                levelUpAnimation();
                
                // Update pixel grid colors for new level
                updatePixelGridColors();
            }
            
            updateStats();
        }

        // Update pixel grid colors based on current level
        function updatePixelGridColors() {
            let colorKey;
            if (gameState.level >= 5) colorKey = 'level5';
            else if (gameState.level >= 4) colorKey = 'level4';
            else if (gameState.level >= 3) colorKey = 'level3';
            else if (gameState.level >= 2) colorKey = 'level2';
            else colorKey = 'level1';
            
            // Update pixel grid with current level color
            gameState.pixelGrid.forEach((pixel, index) => {
                if (pixel !== 'empty') {
                    gameState.pixelGrid[index] = colorKey;
                }
            });
            
            renderPixelGrid();
        }

        // Add a pixel to the grid
        function addPixelToGrid() {
            // Find an empty spot in the grid
            const emptyIndices = gameState.pixelGrid
                .map((pixel, index) => pixel === 'empty' ? index : -1)
                .filter(index => index !== -1);
            
            if (emptyIndices.length > 0) {
                const randomIndex = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
                
                // Determine color based on level
                let colorKey;
                if (gameState.level >= 5) colorKey = 'level5';
                else if (gameState.level >= 4) colorKey = 'level4';
                else if (gameState.level >= 3) colorKey = 'level3';
                else if (gameState.level >= 2) colorKey = 'level2';
                else colorKey = 'level1';
                
                gameState.pixelGrid[randomIndex] = colorKey;
                renderPixelGrid();
            }
        }

        // Remove a pixel from the grid
        function removePixelFromGrid() {
            // Find a filled spot in the grid
            const filledIndices = gameState.pixelGrid
                .map((pixel, index) => pixel !== 'empty' ? index : -1)
                .filter(index => index !== -1);
            
            if (filledIndices.length > 0) {
                const randomIndex = filledIndices[Math.floor(Math.random() * filledIndices.length)];
                gameState.pixelGrid[randomIndex] = 'empty';
                renderPixelGrid();
            }
        }

        // Render the pixel grid
        function renderPixelGrid() {
            pixelGrid.innerHTML = '';
            
            gameState.pixelGrid.forEach((pixelColor, index) => {
                const pixelElement = document.createElement('div');
                pixelElement.className = 'pixel';
                pixelElement.style.backgroundColor = pixelColors[pixelColor] || pixelColors.empty;
                pixelElement.style.animation = `pixel-grow 0.5s ease ${index * 0.02}s both`;
                pixelGrid.appendChild(pixelElement);
            });
        }

        // Update all stats display
        function updateStats() {
            levelElement.textContent = gameState.level;
            currentXpElement.textContent = gameState.xp;
            maxXpElement.textContent = gameState.maxXp;
            
            // Calculate XP fill percentage
            const xpPercentage = (gameState.xp / gameState.maxXp) * 100;
            xpFillElement.style.width = `${xpPercentage}%`;
            
            totalCompletedElement.textContent = gameState.totalCompleted;
            currentStreakElement.textContent = gameState.currentStreak;
            totalDaysElement.textContent = gameState.totalDays;
            
            // Calculate pixel growth percentage
            const filledPixels = gameState.pixelGrid.filter(p => p !== 'empty').length;
            const growthPercentage = Math.round((filledPixels / gameState.pixelGrid.length) * 100);
            pixelGrowthElement.textContent = `${growthPercentage}%`;
            
            // Pulse animation when XP increases
            if (xpPercentage > 0) {
                xpFillElement.style.animation = 'xp-pulse 0.5s ease';
                setTimeout(() => {
                    xpFillElement.style.animation = '';
                }, 500);
            }
        }

        // Create pixel celebration effect
        function createPixelEffect() {
            for (let i = 0; i < 5; i++) {
                const pixel = document.createElement('div');
                pixel.className = 'pixel-effect';
                pixel.style.left = `${Math.random() * 100}%`;
                pixel.style.top = `${Math.random() * 100}%`;
                pixel.style.backgroundColor = getRandomPixelColor();
                pixel.style.width = `${Math.random() * 20 + 5}px`;
                pixel.style.height = pixel.style.width;
                
                animationContainer.appendChild(pixel);
                
                // Animate the pixel
                pixel.animate([
                    { opacity: 1, transform: 'translateY(0) rotate(0deg)' },
                    { opacity: 0, transform: `translateY(-${Math.random() * 100 + 50}px) rotate(${Math.random() * 360}deg)` }
                ], {
                    duration: Math.random() * 1000 + 500,
                    easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                });
                
                // Remove after animation
                setTimeout(() => {
                    pixel.remove();
                }, 1500);
            }
        }

        // Get a random pixel color from the palette
        function getRandomPixelColor() {
            const colors = Object.values(pixelColors).filter(color => color !== pixelColors.empty);
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // Level up animation
        function levelUpAnimation() {
            const levelUpText = document.createElement('div');
            levelUpText.textContent = `LEVEL UP!`;
            levelUpText.style.position = 'absolute';
            levelUpText.style.top = '50%';
            levelUpText.style.left = '50%';
            levelUpText.style.transform = 'translate(-50%, -50%)';
            levelUpText.style.fontSize = '3rem';
            levelUpText.style.color = '#ffcc00';
            levelUpText.style.textShadow = '4px 4px 0 #ff66c4';
            levelUpText.style.zIndex = '100';
            levelUpText.style.animation = 'celebrate 1s ease 3';
            
            document.querySelector('.container').appendChild(levelUpText);
            
            // Create multiple celebration effects
            for (let i = 0; i < 20; i++) {
                setTimeout(() => createPixelEffect(), i * 100);
            }
            
            // Remove after animation
            setTimeout(() => {
                levelUpText.remove();
            }, 3000);
        }

        // Attach event listeners to buttons
        function attachEventListeners() {
            resetDayButton.addEventListener('click', () => {
                // Reset today's habits
                gameState.habits.forEach(habit => {
                    habit.checked = false;
                });
                gameState.totalCompleted = 0;
                
                updateStats();
                renderHabits();
                saveGameState();
                
                // Show confirmation effect
                createPixelEffect();
            });
            
            addHabitButton.addEventListener('click', () => {
                const newHabitName = prompt("ENTER NEW HABIT NAME (MAX 30 CHARS):");
                if (newHabitName && newHabitName.trim() !== '') {
                    const truncatedName = newHabitName.substring(0, 30).toUpperCase();
                    const newHabit = {
                        id: gameState.habits.length + 1,
                        name: truncatedName,
                        streak: 0,
                        checked: false
                    };
                    
                    gameState.habits.push(newHabit);
                    renderHabits();
                    saveGameState();
                    
                    // Celebration effect
                    createPixelEffect();
                }
            });
            
            celebrateButton.addEventListener('click', () => {
                // Create a big celebration
                for (let i = 0; i < 30; i++) {
                    setTimeout(() => createPixelEffect(), i * 50);
                }
                
                // Animate the pixel character
                const pixelCharacter = document.querySelector('.pixel-character');
                pixelCharacter.style.animation = 'celebrate 1s ease 3';
                setTimeout(() => {
                    pixelCharacter.style.animation = '';
                }, 3000);
            });
        }

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>